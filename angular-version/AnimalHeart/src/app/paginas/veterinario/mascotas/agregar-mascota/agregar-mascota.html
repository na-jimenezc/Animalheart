
<div class="form-container">
  <div class="form-body">
    <form [formGroup]="mascotaForm" (ngSubmit)="onSubmit()">
      <!-- Sección de la foto -->
      <div class="form-section">
        <h2 class="form-section-title">
          <i class="bi bi-camera"></i>Foto de la Mascota
        </h2>
        <div class="photo-container">
          <div class="photo-placeholder" id="photoPlaceholder" *ngIf="!mascotaForm.get('fotoUrl')?.value">
            <i class="bi bi-camera me-2"></i> Imagen de la mascota
          </div>
          <img [src]="mascotaForm.get('fotoURL')?.value" class="photo-preview" id="fotoPreview" 
               *ngIf="mascotaForm.get('fotoURL')?.value"
               (error)="onImageError()" />
        </div>
        
        <div class="form-field">
          <label class="form-label">URL de la Foto</label>
          <input type="url" formControlName="fotoUrl" class="form-input" 
                 placeholder="https://ejemplo.com/imagen.jpg" id="fotoURLInput"
                 (input)="onFotoUrlChange()" />
          <div class="form-text">Pega la URL de una imagen o deja vacío para usar imagen por defecto</div>
        </div>
      </div>

      <!-- Sección de información de la mascota -->
      <div class="form-section">
        <h2 class="form-section-title">
          <i class="bi bi-info-circle"></i>Información de la Mascota
        </h2>
        
        <div class="form-grid">
          <div class="form-field">
            <label class="form-label required">Nombre de la Mascota</label>
            <input type="text" formControlName="nombre" class="form-input" required 
                   placeholder="Ej: Firulais" />
            <div *ngIf="submitted && f['nombre'].errors" class="error-message">
              <div *ngIf="f['nombre'].errors['required']">El nombre es requerido</div>
            </div>
          </div>

          <div class="form-field">
            <label class="form-label required">Edad (años)</label>
            <input type="number" formControlName="edad" class="form-input" min="0" max="30" required 
                   placeholder="Ej: 3" />
            <div *ngIf="submitted && f['edad'].errors" class="error-message">
              <div *ngIf="f['edad'].errors['required']">La edad es requerida</div>
              <div *ngIf="f['edad'].errors['min']">La edad mínima es 0</div>
              <div *ngIf="f['edad'].errors['max']">La edad máxima es 30</div>
            </div>
          </div>

          <div class="form-field">
            <label class="form-label required">Tipo de Animal</label>
            <select formControlName="tipo" class="form-select" required (change)="onTipoChange()">
              <option value="">Seleccionar...</option>
              <option value="Perro">Perro</option>
              <option value="Gato">Gato</option>
            </select>
            <div *ngIf="submitted && f['tipo'].errors" class="error-message">
              <div *ngIf="f['tipo'].errors['required']">El tipo es requerido</div>
            </div>
          </div>

          <div class="form-field">
            <label class="form-label required">Raza</label>
            <input type="text" formControlName="raza" class="form-input" 
                   placeholder="Ej: Criollo, Labrador, etc." required />
            <div *ngIf="submitted && f['raza'].errors" class="error-message">
              <div *ngIf="f['raza'].errors['required']">La raza es requerida</div>
            </div>
          </div>

          <div class="form-field">
            <label class="form-label">Peso (kg)</label>
            <input type="number" step="0.1" formControlName="peso" class="form-input" 
                   placeholder="Ej: 5.2" min="0" />
          </div>

          <div class="form-field">
            <label class="form-label">Enfermedad/Diagnóstico</label>
            <input type="text" formControlName="enfermedad" class="form-input" 
                   placeholder="Ej: Ninguna, Alergias, etc." />
          </div>
        </div>
      </div>

      <!-- Sección del dueño -->
      <div class="form-section">
        <h2 class="form-section-title">
          <i class="bi bi-person"></i>Información del Dueño
        </h2>
        
        <div class="form-field">
          <label class="form-label required">Seleccionar Cliente</label>
          <select formControlName="clienteId" class="form-select" required id="clienteSelect" (change)="onClienteChange()">
            <option value="">Seleccionar cliente existente...</option>
            <option *ngFor="let cliente of clientes" [value]="cliente.id">
              {{ cliente.nombre }} - C.C. {{ cliente.cedula }}
            </option>
          </select>
          <div *ngIf="submitted && f['clienteId'].errors" class="error-message">
            <div *ngIf="f['clienteId'].errors['required']">Debe seleccionar un cliente</div>
          </div>
        </div>

        <div class="inline-actions">
          <a routerLink="/clientes/nuevo" class="btn-inline">
            <i class="bi bi-person-plus me-2"></i> Registrar nuevo cliente
          </a>
        </div>

        <div id="clientInfo" *ngIf="clienteSeleccionado">
          <div class="client-card">
            <div class="client-info">
              <div class="client-avatar">
                <i class="bi bi-person"></i>
              </div>
              <div class="client-details">
                <h4>{{ clienteSeleccionado.nombre }}</h4>
                <p>C.C. {{ clienteSeleccionado.cedula }} | {{ clienteSeleccionado.correo }} | {{ clienteSeleccionado.celular }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Botones -->
      <div class="btn-container">
        <a routerLink="/mascotas/ver-mascotas" class="btn-secondary">
          <i class="bi bi-x-circle me-2"></i>Cancelar
        </a>
        <button type="submit" class="btn-primary" [disabled]="guardando" >
          <i class="bi bi-check-circle me-2"></i>Registrar Mascota
        </button>
      </div>
    </form>
  </div>
</div>